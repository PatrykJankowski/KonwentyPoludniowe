<ion-header no-border class="header">
  <ion-toolbar class="header__toolbar">

    <ion-title class="header__title">
      <img alt="Konwenty Południowe" src="assets/logo.png" class="header__logo">
    </ion-title>

    <ion-grid class="header__grid">
      <ion-row>
        <ion-col size="3">
          <ion-item class="header__item">
            <div class="filter">
              <ion-label class="filter__label">Kategoria:</ion-label>
              <div class="filter__arrow"></div>
              <ion-select class="filter__option" ok-text="Potwierdź" cancel-text="Anuluj" [formControl]="categoryFilter">
                <ion-select-option value="" selected>Wszystkie</ion-select-option>
                <ion-select-option *ngFor="let category of categories" value="{{ category }}">{{ category }}</ion-select-option>
              </ion-select>
            </div>
          </ion-item>
        </ion-col>

        <ion-col size="3">
          <ion-item class="header__item">
            <div class="filter">
              <ion-label class="filter__label">Miasto:</ion-label>
              <div class="filter__arrow"></div>
              <ion-select class="filter__option" ok-text="Potwierdź" cancel-text="Anuluj" [formControl]="locationFilter">
                <ion-select-option value="" selected>Wszystkie</ion-select-option>
                <ion-select-option *ngFor="let location of locations" value="{{ location }}">{{ location }}</ion-select-option>
              </ion-select>
            </div>
          </ion-item>
        </ion-col>

        <ion-col size="3">
          <ion-item class="header__item">
            <div class="filter">
              <ion-label class="filter__label filter__label--date">Data:</ion-label>
              <ion-datetime class="filter__option filter__option--date" value="2019-06" display-format="YYYY-MM" doneText="Potwierdź" cancelText="Anuluj" [formControl]="dateFilter"></ion-datetime>
            </div>
          </ion-item>
        </ion-col>

        <ion-col size="3">
          <div class="filter">
            <div class="filter__label filter__label--fav">Ulubione:</div>
            <ion-icon name="star-outline" class="filter__fav" *ngIf="!favouritesOnly" (click)="favouritesFilter()"></ion-icon>
            <ion-icon name="star" class="filter__fav" *ngIf="favouritesOnly" (click)="favouritesFilter()"></ion-icon>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-toolbar>

  <ion-searchbar placeholder="Szukaj..." class="header__searchbar" [formControl]="searchField"></ion-searchbar>

</ion-header>

<ion-content>

  <ion-refresher slot="fixed" (ionRefresh)="loadData(true, $event)">
    <ion-refresher-content>
    </ion-refresher-content>
  </ion-refresher>

  <div class="event-card" *ngFor="let event of filteredEvents">

    <button ion-button icon-only (click)="addToFavourites(event.id)" *ngIf="!isFavourite(event.id)" class="event-card__fav"><ion-icon name="star-outline"></ion-icon></button>
    <button ion-button icon-only (click)="removeFromFavourites(event.id)" *ngIf="isFavourite(event.id)" class="event-card__fav"><ion-icon name="star"></ion-icon></button>

    <!--<img src="assets/icon/fav.png" class="event-card__fav" (click)="addToFavourites(event.id)">-->

    <ion-card [routerLink]="['/event-details', event.id]">
      <ion-card-content class="event-card__inner">
        <ion-grid>
          <ion-row align-items-center>
            <ion-col size="5">
              <ion-thumbnail class="event-card__thumb">
                <img src="{{ event.image }}" alt="Image - {{ event.name}}">
              </ion-thumbnail>
            </ion-col>
            <ion-col no-padding>
              <ion-row text-center>
                <h2 class="event-card__title">{{ (event.name.length>18) ? (event.name | slice:0:18) + '...' : (event.name) }}</h2>
              </ion-row>
              <ion-row text-center>
                <h4 class="event-card__category">{{ event.event_type }}</h4>
              </ion-row>
              <ion-row text-center>
                <h3 class="event-card__location">{{ event.location }}</h3>
              </ion-row>
              <ion-row justify-content-end>
                <time datetime="2017-02-14" class="event-card__date">{{ event.date_begin }}</time>
              </ion-row>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card-content>
    </ion-card>
  </div>

</ion-content>
